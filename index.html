<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ATB 101: Your Story, Your Way</title>
  <meta name="description" content="A choose-your-own-adventure built for my ATB application." />

  <style>
    :root{
      --bg: #f6f9ff;
      --card: #ffffff;
      --ink: #0b1b3a;
      --muted: #3d537a;

      --atb-blue: #0057b8;
      --atb-blue-2: #1b74e4;

      --line: #d7e4ff;
      --shadow: 0 10px 30px rgba(0, 25, 80, 0.10);
      --radius: 16px;
    }

    body{
      margin: 0;
      background: radial-gradient(1200px 600px at 20% 0%, #eaf2ff 0%, var(--bg) 60%, #ffffff 100%);
      color: var(--ink);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }

    .wrap{
      max-width: 820px;
      margin: 0 auto;
      padding: 26px 18px 40px;
    }

    .top{
      display: flex;
      gap: 12px;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 14px;
    }

    .brand{
      display: grid;
      gap: 4px;
    }

    .brand h1{
      font-size: 18px;
      margin: 0;
      letter-spacing: 0.2px;
    }

    .brand .sub{
      font-size: 13px;
      color: var(--muted);
    }

    .badge{
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 8px 10px;
      border: 1px solid var(--line);
      background: #fff;
      border-radius: 999px;
      color: var(--muted);
      font-size: 13px;
      box-shadow: 0 6px 18px rgba(0, 25, 80, 0.06);
      user-select: none;
    }

    .dot{
      width: 9px; height: 9px;
      background: var(--atb-blue);
      border-radius: 999px;
      box-shadow: 0 0 0 4px rgba(0,87,184,0.10);
    }

    .card{
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: var(--radius);
      padding: 18px;
      box-shadow: var(--shadow);
    }

    #text{
      font-size: 18px;
      line-height: 1.55;
      white-space: pre-wrap;
    }

    .choices{
      margin-top: 16px;
      display: grid;
      gap: 10px;
    }

    button.choice{
      border: 1px solid var(--line);
      background: linear-gradient(180deg, #ffffff 0%, #f2f7ff 100%);
      border-radius: 14px;
      padding: 12px 12px;
      cursor: pointer;
      text-align: left;
      font-size: 16px;
      color: var(--ink);
      transition: transform 0.06s ease, box-shadow 0.15s ease, border-color 0.15s ease;
    }

    button.choice:hover{
      border-color: #b8d0ff;
      box-shadow: 0 10px 18px rgba(0, 87, 184, 0.12);
      transform: translateY(-1px);
    }

    button.choice:active{
      transform: translateY(0px);
      box-shadow: 0 6px 12px rgba(0, 87, 184, 0.10);
    }

    .row{
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items: center;
      margin-top: 14px;
    }

    .pill{
      border: 1px solid var(--line);
      background: #fff;
      border-radius: 999px;
      padding: 8px 10px;
      font-size: 13px;
      color: var(--muted);
      user-select: none;
    }

    .controls{
      margin-left: auto;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    button.small{
      border: 1px solid var(--line);
      background: #fff;
      border-radius: 999px;
      padding: 8px 12px;
      font-size: 13px;
      color: var(--atb-blue);
      cursor: pointer;
    }

    button.small:hover{
      border-color: #b8d0ff;
      box-shadow: 0 8px 14px rgba(0, 87, 184, 0.10);
    }

    .score{
      display: grid;
      grid-template-columns: repeat(3, minmax(140px, 1fr));
      gap: 10px;
      margin-top: 12px;
    }

    .kpi{
      border: 1px solid var(--line);
      border-radius: 14px;
      padding: 10px 12px;
      background: linear-gradient(180deg, #ffffff 0%, #f6f9ff 100%);
    }

    .kpi .label{
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 6px;
    }

    .kpi .value{
      font-size: 16px;
      font-weight: 650;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .bar{
      height: 8px;
      background: #eaf2ff;
      border-radius: 999px;
      overflow: hidden;
      margin-top: 8px;
      border: 1px solid var(--line);
    }

    .fill{
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, var(--atb-blue) 0%, var(--atb-blue-2) 100%);
    }

    .footer{
      margin-top: 14px;
      font-size: 13px;
      color: var(--muted);
    }

    code{ background:#eef4ff; padding:2px 6px; border-radius:8px; border:1px solid var(--line); }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="top">
      <div class="brand">
        <h1>ATB 101: Your Story, Your Way</h1>
        <div class="sub">MY CYOA.</div>
      </div>
      <div class="badge"><span class="dot"></span><span id="where">loading…</span></div>
    </div>

    <div class="card">
      <div id="text">Loading story…</div>

      <div class="score" aria-label="Scoreboard">
        <div class="kpi">
          <div class="label">Impact in action</div>
          <div class="value"><span id="vImpact">0</span> / 10</div>
          <div class="bar"><div class="fill" id="bImpact"></div></div>
        </div>
        <div class="kpi">
          <div class="label">Thrive together</div>
          <div class="value"><span id="vThrive">0</span> / 10</div>
          <div class="bar"><div class="fill" id="bThrive"></div></div>
        </div>
        <div class="kpi">
          <div class="label">Ready for tomorrow</div>
          <div class="value"><span id="vReady">0</span> / 10</div>
          <div class="bar"><div class="fill" id="bReady"></div></div>
        </div>
      </div>

      <div class="choices" id="choices"></div>

      <div class="row">
        <div class="pill" id="saveState">Autosave: on</div>
        <div class="controls">
          <button class="small" id="restart">Restart</button>
          <button class="small" id="share">Copy share link</button>
        </div>
      </div>

      <div class="footer">
        Tip: you can link directly to a scene using <code>#nodeId</code>. Your choices and score autosave in your browser.
      </div>
    </div>
  </div>

  <script>
    // Embedded story (single-file mode)
    const STORY = {
      "start": "coldOpen",
      "nodes": {
        "coldOpen": {
          "text": "You open your laptop.\\n\\nCalendar: “ATB 101 — Tell us your story, your way.”\\n\\nYou click the portal.\\nThe deadline says:\\n\\n“BY February 12.”\\n\\nNot “11:59 PM.”\\nNot “end of day.”\\n\\nJust: BY.\\n\\nSomehow, you understand this to mean due by February 12th. Not a good look.\\nThen you get an email.\\n\\nAlso open on your laptop:\\n- Bowman Tax Moot factum draft\\n- MLSA speakers panel planning doc (with a budget that is actively insulting)\\n- Corporate Reorganization slides: “CCAA + Winalta”\\n\\nClock: Feb 10th, evening.\\n\\nWhat do you do first?",
          "choices": [
            { "label": "Factum first (remove existential threat)", "to": "factumTab", "delta": { "ready": 2 } },
            { "label": "MLSA panel first (people are counting on you)", "to": "mlsaTab", "delta": { "thrive": 2 } },
            { "label": "Corporate Reorg prep: CCAA/Winalta slides (tomorrow is real)", "to": "winaltaTab", "delta": { "impact": 1, "ready": 1 } },
            { "label": "Start the ATB application now (dangerous, timewise but exciting)", "to": "atbTab", "delta": { "ready": 1 } }
          ]
        },

        "factumTab": {
          "text": "You open the factum.\\n\\nYou tell yourself:\\n“One tiny edit. Then I submit.”\\n\\nYou change one sentence.\\nThen you notice a comma.\\nThen the comma reminds you of a footnote.\\nThen the footnote reminds you of a case.\\n\\nYou check the time.\\n\\nSomehow it is now 2:47 AM.\\n\\nYou stare into the abyss.\\nThe abyss offers Track Changes.\\n\\nWhat do you do?",
          "choices": [
            { "label": "Hard stop. Submit the clear version. No more micro-edits.", "to": "factumSubmit", "delta": { "ready": 2 } },
            { "label": "One more edit (this is the last one, for real)", "to": "factumSpiral", "delta": { "ready": 1 } }
          ]
        },

        "factumSpiral": {
          "text": "You do one more edit.\\n\\nThen you do the edit that fixes the edit.\\n\\nThen you do the edit that makes the intro “flow.”\\n\\nThen you re-read one paragraph and think:\\n“Wait. If I change this word, the whole argument becomes… cleaner.”\\n\\nThis is how you accidentally invent a new hobby:\\nMidnight micro-surgery.\\n\\nYou check the file name.\\nIt is currently:\\n\\nfactum_FINAL_v7_REALFINAL_clean_THISONE.docx\\n\\nYou make it worse:\\n\\nfactum_FINAL_v8_REALFINAL_clean_THISONE_ACTUALLY.docx\\n\\nYou check the time.\\n\\nIt is 3:07 AM.\\n\\nYou have become the kind of person who says “just one more tweak” and means it spiritually, not literally.\\n\\nWhat do you do?",
          "choices": [
            { "label": "Emergency landing: submit now, close laptop, walk away", "to": "factumSubmit", "delta": { "ready": 2 } },
            { "label": "Keep editing (it could become perfect by sunrise)", "to": "factumSunrise", "delta": { "ready": 1 } }
          ]
        },

        "factumSunrise": {
          "text": "You keep editing.\\n\\nAt some point you realize you are not writing anymore.\\nYou are litigating with yourself.\\n\\nYou read it aloud.\\nHalfway through you start sounding like you’re cross-examining your own sentence structure.\\n\\nYou glance outside.\\nThe sky is considering becoming morning.\\n\\nThis is your last sane moment to choose clarity over obsession.\\n\\nWhat do you do?",
          "choices": [
            { "label": "Submit right now (future-you can process feelings later)", "to": "factumSubmit", "delta": { "ready": 2 } },
            { "label": "Set a 10-minute timer, then submit no matter what", "to": "timerTrick", "delta": { "ready": 2 } }
          ]
        },

        "timerTrick": {
          "text": "You set a 10-minute timer.\\n\\nIt goes off.\\nYou ignore it.\\n\\nYou set a 3-minute timer.\\n\\nIt goes off.\\nYou stare at it like it’s opposing counsel.\\n\\nYou realize: the timer is right.\\n\\nYou submit.\\n\\nNothing explodes.\\nNo alarms.\\nNo dramatic email.\\n\\nYou win the smallest war imaginable.\\n\\nClock: Feb 12, 5:18 AM.\\n\\nNext: MLSA and Corporate Reorg are still real.",
          "choices": [
            { "label": "Power nap (short) then MLSA panel logistics", "to": "mlsaTab", "delta": { "thrive": 1, "ready": 1 } },
            { "label": "Power nap (short) then CCAA/Winalta presentation prep", "to": "winaltaTab", "delta": { "impact": 1, "ready": 1 } }
          ]
        },

        "factumSubmit": {
          "text": "You submit the factum.\\n\\nThe portal does not explode.\\nThe laptop fan slows down like it just finished a marathon.\\n\\nYou look back at the ATB portal.\\n\\n“BY February 12.”\\n\\nIt feels… judgmental.\\n\\nWhat do you tackle next?",
          "choices": [
            { "label": "MLSA speakers panel planning", "to": "mlsaTab", "delta": { "thrive": 2 } },
            { "label": "Corporate Reorg: CCAA/Winalta presentation prep", "to": "winaltaTab", "delta": { "impact": 1, "ready": 1 } },
            { "label": "ATB application (before time becomes an enemy)", "to": "atbTab", "delta": { "ready": 2 } }
          ]
        },

        "mlsaTab": {
          "text": "MLSA speakers panel planning.\\n\\nOne speaker hasn’t confirmed.\\nThe room booking link looks like it was built when BlackBerry was a lifestyle.\\n\\nThen you open the budget.\\n\\nFood prices:\\nAggressively un-serious.\\n\\nSomeone messages:\\n“Can we do something nice, but also… not go bankrupt?”\\n\\nWhat’s your move?",
          "choices": [
            { "label": "Negotiate: call/email vendors and make the budget behave", "to": "foodNegotiation", "delta": { "thrive": 2, "ready": 1 } },
            { "label": "Find a cheaper plan fast (shawarma diplomacy)", "to": "pizzaDiplomacy", "delta": { "thrive": 1, "ready": 1 } },
            { "label": "Delegate tasks clearly (who/what/by when) and keep moving", "to": "delegateMLSA", "delta": { "thrive": 2 } }
          ]
        },

        "foodNegotiation": {
          "text": "You become a negotiator.\\n\\nYou email a vendor politely.\\nThey send a quote.\\nYou counter politely.\\nThey counter back.\\n\\nYou discover your legal skillset applies surprisingly well to sandwiches.\\n\\nYou get the price down.\\nYou feel unstoppable.\\n\\nYou update the team.\\nThey react like you just won an Olympic medal!\\n\\nMLSA is stabilizing.\\n\\nWhat next?",
          "choices": [
            { "label": "Lock the speaker confirmations and finalize logistics", "to": "mlsaLocked", "delta": { "thrive": 2, "ready": 1 } },
            { "label": "Switch to Corporate Reorg prep (CCAA/Winalta)", "to": "winaltaTab", "delta": { "impact": 1, "ready": 1 } }
          ]
        },

        "pizzaDiplomacy": {
          "text": "You choose shawarma diplomacy.\\n\\nIt is not glamorous.\\nBut it is effective.\\n\\nYou pick a vendor.\\nYou keep the budget alive.\\nYou preserve morale.\\n\\nSomeone says:\\n“Honestly, this is perfect.”\\n\\nMLSA is moving.\\n\\nWhat next?",
          "choices": [
            { "label": "Finalize speaker confirmations and event timeline", "to": "mlsaLocked", "delta": { "thrive": 2 } },
            { "label": "Jump to Corporate Reorg prep", "to": "winaltaTab", "delta": { "impact": 1, "ready": 1 } }
          ]
        },

        "delegateMLSA": {
          "text": "You delegate.\\n\\nNot vague delegation.\\nReal delegation:\\n- You: vendor negotiations\\n- Person A: speaker confirmations\\n- Person B: room booking + A/V\\n- Person C: poster + socials\\n\\nYou don’t do everything.\\nYou make everything happen.\\n\\nMLSA is now a machine.\\n\\nWhat next?",
          "choices": [
            { "label": "Corporate Reorg prep (CCAA/Winalta)", "to": "winaltaTab", "delta": { "impact": 1, "ready": 1 } },
            { "label": "ATB application", "to": "atbTab", "delta": { "ready": 2 } }
          ]
        },

        "mlsaLocked": {
          "text": "The MLSA panel is locked.\\nSpeakers confirmed.\\nRoom booked.\\nFood handled.\\nBudget still alive.\\n\\nYou feel a rare emotion:\\nAdministrative peace.\\n\\nYou check the clock.\\nIt is February 12.\\n\\nYour eyes drift back to ATB:\\n“BY February 12.”\\n\\nThat word “BY” is now doing psychological damage.\\n\\nWhat do you do?",
          "choices": [
            { "label": "Corporate Reorg prep quickly, then ATB", "to": "winaltaTab", "delta": { "impact": 1, "ready": 1 } },
            { "label": "ATB application immediately (do not tempt fate)", "to": "atbTab", "delta": { "ready": 2 } }
          ]
        },

        "winaltaTab": {
          "text": "Corporate Reorganization prep.\\n\\nTopic: CCAA.\\nCase: Winalta.\\n\\nYou open your notes.\\nThe monitor.\\nThe creditor.\\nThe line between “court officer” and “consultant.”\\n\\nYou realize this presentation is basically:\\n“How to be useful without crossing the line.”\\n\\nWhich is… also a life theme.\\n\\nHow do you prep?",
          "choices": [
            { "label": "Make it story-driven: players, conflict, what the court did", "to": "winaltaStory", "delta": { "impact": 2, "ready": 1 } },
            { "label": "Make it tight: issue → rule → application → takeaway", "to": "winaltaIRAC", "delta": { "ready": 2 } }
          ]
        },

        "winaltaStory": {
          "text": "You build it like a story.\\n\\nCast of characters.\\nWhat went wrong.\\nWhy it mattered.\\nWhat the court did about it.\\n\\nYou add one slide that is just:\\n“Where is the line?”\\n\\nAnd you know you’ll land it.\\n\\nNow you check the date.\\nFebruary 12.\\n\\nThe ATB portal is still open.\\nStill saying BY.\\n\\nWhat next?",
          "choices": [
            { "label": "ATB application now", "to": "atbTab", "delta": { "ready": 2 } },
            { "label": "Do one final quick rehearsal of the Winalta section", "to": "winaltaRehearse", "delta": { "ready": 1 } }
          ]
        },

        "winaltaIRAC": {
          "text": "You go full structure.\\nIssue → rule → application → takeaway.\\n\\nIt’s crisp!\\nIt’s teachable!?\\nIt makes sense to people who didn’t live inside the case.\\n\\nYou realize this is maybe a strength:\\nmaking complex law usable.\\n\\nThen you remember:\\nATB.\\nBY Feb 12.\\n\\nWhat next?",
          "choices": [
            { "label": "ATB application now", "to": "atbTab", "delta": { "ready": 2 } },
            { "label": "Quick rehearsal first", "to": "winaltaRehearse", "delta": { "ready": 1 } }
          ]
        },

        "winaltaRehearse": {
          "text": "You rehearse.\\n\\nYou catch one slide that is doing too much.\\nYou simplify it.\\n\\nYou feel the difference immediately.\\n\\nThe presentation is ready.\\n\\nNow: ATB.\\n\\nYou look again.\\nBY February 12.\\n\\nAnd you have the sinking feeling that “BY” did not mean “whenever you feel like it.”",
          "choices": [
            { "label": "Go to ATB application", "to": "atbTab", "delta": { "ready": 2 } }
          ]
        },

        "atbTab": {
          "text": "ATB says:\\n\\n“Tell us Your Story, Your Way.”\\n\\nYou open a folder called:\\nATB_APPLICATION_IDEAS_FINAL_FINAL_REALLYFINAL\\n\\nInside:\\n- podcast idea\\n- video idea\\n- written narrative idea\\n- a doc titled: “none of these are really YOUSAFF”\\n\\nYou stare at it.\\n\\nTruth: when you’re nervous, you build.\\nWhen you’re excited, you build.\\nWhen you’re procrastinating… you also build.\\n\\nSo you build a tiny game.\\n\\nBut then the hard question:\\nHow do you make it feel like you without turning it into a speech?",
          "choices": [
            { "label": "Make it a timeline through real moments (factum, MLSA, Winalta, then ATB)", "to": "timelineMode", "delta": { "ready": 2, "impact": 1 } },
            { "label": "Make it 'values' themed (risk: sounds like a corporate poster)", "to": "posterRisk", "delta": { "ready": 1 } }
          ]
        },

        "posterRisk": {
          "text": "You write something very inspirational.\\n\\nIt is technically fine.\\n\\nBut you read it back and it sounds like a brand campaign.\\n\\nYou close the doc.\\nYou open the game again.\\n\\nNo preaching.\\nOnly scenes.\\nOnly real moments.\\n\\nOkay. Timeline it is.",
          "choices": [
            { "label": "Switch to timeline mode", "to": "timelineMode", "delta": { "ready": 2 } }
          ]
        },

        "timelineMode": {
          "text": "Rule you set:\\n\\nIf it matters, it shows up in the choices.\\nNot in a speech.\\n\\nYou build the story around real moments:\\n- late-night factum edits that turn into 3 AM\\n- MLSA logistics + budget negotiations\\n- presenting on the CCAA and Winalta\\n\\nAnd then you remember the original problem.\\n\\nBY Feb 12.\\n\\nYou check the clock.\\nYou feel a little sick.\\n\\nAre you late?",
          "choices": [
            { "label": "Try submitting right now and hope the portal is forgiving", "to": "submitAttempt", "delta": { "ready": 1 } },
            { "label": "Email for reprieve (accountable, concise, respectful)", "to": "reprieveEmail", "delta": { "thrive": 1, "ready": 1 } }
          ]
        },

        "submitAttempt": {
          "text": "You click submit.\\n\\nThe portal thinks.\\n\\nYou think.\\n\\nThe portal thinks harder.\\n\\nThen it does the worst possible thing:\\nIt shows an error.\\n\\nYou stare at it like it’s a hostile witness.\\n\\nYou have one sensible move left.",
          "choices": [
            { "label": "Send the reprieve email (polite, concise, accountable)", "to": "reprieveEmail", "delta": { "thrive": 1, "ready": 1 } }
          ]
        },

        "reprieveEmail": {
          "text": "You open a blank email.\\n\\nYou pick the tone:\\n- accountable (no excuses)\\n- respectful (they owe you nothing)\\n- practical (you can submit immediately)\\n\\nYou hit send.\\n\\nThen you stare at your sent folder like it’s going to speak.\\n\\nENDING: Not perfect. Just real. And you shipped anyway.",
          "ending": true
        }
      }
    };

    // Simple state that maps to ATB themes
    const MAX = 10;
    const STORE_KEY = "atb101_cyoa_v1";

    let state = { impact: 0, thrive: 0, ready: 0, node: null };

    const elText = document.getElementById("text");
    const elChoices = document.getElementById("choices");
    const elWhere = document.getElementById("where");

    const vImpact = document.getElementById("vImpact");
    const vThrive = document.getElementById("vThrive");
    const vReady = document.getElementById("vReady");

    const bImpact = document.getElementById("bImpact");
    const bThrive = document.getElementById("bThrive");
    const bReady = document.getElementById("bReady");

    const btnRestart = document.getElementById("restart");
    const btnShare = document.getElementById("share");

    function clamp(n){ return Math.max(0, Math.min(MAX, n)); }

    function loadSaved(){
      try{
        const raw = localStorage.getItem(STORE_KEY);
        if(!raw) return;
        const parsed = JSON.parse(raw);
        if(parsed && typeof parsed === "object") state = { ...state, ...parsed };
      }catch(_){}
    }

    function save(){
      try{ localStorage.setItem(STORE_KEY, JSON.stringify(state)); }catch(_){}
    }

    function setHash(nodeId){
      history.replaceState(null, "", "#" + encodeURIComponent(nodeId));
    }

    function getHash(){
      const h = decodeURIComponent(location.hash.replace("#","")).trim();
      return h || null;
    }

    function escapeHtml(s){
      return (s ?? "")
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;");
    }

    function updateScoreboard(){
      state.impact = clamp(state.impact);
      state.thrive = clamp(state.thrive);
      state.ready = clamp(state.ready);

      vImpact.textContent = state.impact;
      vThrive.textContent = state.thrive;
      vReady.textContent = state.ready;

      bImpact.style.width = (state.impact / MAX * 100) + "%";
      bThrive.style.width = (state.thrive / MAX * 100) + "%";
      bReady.style.width = (state.ready / MAX * 100) + "%";
    }

    function applyDelta(delta){
      if(!delta) return;
      state.impact += (delta.impact || 0);
      state.thrive += (delta.thrive || 0);
      state.ready += (delta.ready || 0);
      updateScoreboard();
    }

    function goto(nodeId){
      const node = STORY.nodes[nodeId];
      if(!node){
        elText.textContent = "Missing node: " + nodeId;
        elChoices.innerHTML = "";
        elWhere.textContent = "error";
        return;
      }

      state.node = nodeId;
      setHash(nodeId);
      save();

      elWhere.textContent = "node: " + nodeId;
      elText.innerHTML = escapeHtml(node.text);

      elChoices.innerHTML = "";

      if(node.ending){
        const btn = document.createElement("button");
        btn.className = "choice";
        btn.textContent = "Play again (keep score)";
        btn.onclick = () => goto(STORY.start);
        elChoices.appendChild(btn);

        const btn2 = document.createElement("button");
        btn2.className = "choice";
        btn2.textContent = "Restart from zero";
        btn2.onclick = () => {
          state = { impact: 0, thrive: 0, ready: 0, node: STORY.start };
          updateScoreboard();
          save();
          goto(STORY.start);
        };
        elChoices.appendChild(btn2);

        return;
      }

      for(const c of (node.choices || [])){
        const btn = document.createElement("button");
        btn.className = "choice";
        btn.textContent = c.label;
        btn.onclick = () => {
          applyDelta(c.delta);
          goto(c.to);
        };
        elChoices.appendChild(btn);
      }
    }

    function main(){
      loadSaved();
      updateScoreboard();
      const start = getHash() || state.node || STORY.start;
      goto(start);
    }

    btnRestart.onclick = () => goto(STORY.start);

    btnShare.onclick = async () => {
      const url = location.href;
      try{
        await navigator.clipboard.writeText(url);
        btnShare.textContent = "Copied";
        setTimeout(() => btnShare.textContent = "Copy share link", 900);
      }catch(_){
        prompt("Copy this link:", url);
      }
    };

    window.addEventListener("hashchange", () => {
      const target = getHash();
      if(target && STORY.nodes[target]) goto(target);
    });

    main();
  </script>
</body>
</html>
